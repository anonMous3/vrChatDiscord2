<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch Guild Members</title>
</head>
<body>
    <h1>Guild Members</h1>
    <p id="message">Loading...</p>

    <script>
        // Function to get URL parameters
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Function to fetch members and display result
        async function fetchMembers(guildId, roleName) {
            try {
                const response = await fetch(`https://scarlet-sprinkle-weaver.glitch.me/list-members?guildId=${guildId}&roleName=${roleName}`);
                if (response.ok) {
                    const text = await response.text();
                    document.getElementById('message').textContent = text || 'No members found.';
                } else {
                    document.getElementById('message').textContent = 'Error fetching members.';
                }
            } catch (error) {
                document.getElementById('message').textContent = 'Error fetching members.';
                console.error('Error:', error);
            }
        }

        // Populate form fields with URL parameters and fetch data
        document.addEventListener('DOMContentLoaded', () => {
            const guildId = getUrlParameter('guildId');
            const roleName = getUrlParameter('roleName');

            if (guildId && roleName) {
                fetchMembers(guildId, roleName);
            } else {
                document.getElementById('message').textContent = 'Missing guildId or roleName.';
            }
        });
    </script>
</body>
</html>
